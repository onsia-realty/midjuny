const fs=require("fs"),d="D:/claude/onsia-midjuny/hooks/";
const b=require("buffer");
const h1="J3VzZSBjbGllbnQnOwoKaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB0eXBlIHsgUHJvbXB0SGlzdG9yeSwgUHJvbXB0SW5wdXQsIFByb21wdE91dHB1dCB9IGZyb20gJ0AvdHlwZXMvcHJvbXB0JzsKaW1wb3J0IHsgZ2V0SGlzdG9yeSwgYWRkSGlzdG9yeSwgdXBkYXRlSGlzdG9yeSwgZGVsZXRlSGlzdG9yeSwgY2xlYXJIaXN0b3J5IGFzIGNsZWFyQWxsLCB0b2dnbGVGYXZvcml0ZSBhcyB0b2dnbGVGYXYsIHJhdGVIaXN0b3J5IGFzIHJhdGUsIGdldEZhdm9yaXRlcyB9IGZyb20gJ0AvbGliL3N0b3JhZ2UvaGlzdG9yeVN0b3JlJzsKCmV4cG9ydCBmdW5jdGlvbiB1c2VIaXN0b3J5KCkgewogIGNvbnN0IFtoaXN0b3J5LCBzZXRIaXN0b3J5XSA9IHVzZVN0YXRlPFByb21wdEhpc3RvcnlbXT4oW10pOwogIGNvbnN0IFtmYXZvcml0ZXMsIHNldEZhdm9yaXRlc10gPSB1c2VTdGF0ZTxQcm9tcHRIaXN0b3J5W10+KFtdKTsKCiAgY29uc3QgcmVmcmVzaCA9IHVzZUNhbGxiYWNrKCgpID0+IHsKICAgIHNldEhpc3RvcnkoZ2V0SGlzdG9yeSgpKTsKICAgIHNldEZhdm9yaXRlcyhnZXRGYXZvcml0ZXMoKSk7CiAgfSwgW10pOwoKICB1c2VFZmZlY3QoKCkgPT4geyByZWZyZXNoKCk7IH0sIFtyZWZyZXNoXSk7CgogIGNvbnN0IHNhdmVUb0hpc3RvcnkgPSB1c2VDYWxsYmFjaygoaW5wdXQ6IFByb21wdElucHV0LCBvdXRwdXQ6IFByb21wdE91dHB1dCkgPT4gewogICAgY29uc3QgZW50cnk6IFByb21wdEhpc3RvcnkgPSB7CiAgICAgIGlkOiBgaGlzdF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiwgOCl9YCwKICAgICAgaW5wdXQsIG91dHB1dCwgcmF0aW5nOiAwLCBpc0Zhdm9yaXRlOiBmYWxzZSwgdGFnczogW10sIG5vdGVzOiAnJywKICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICB9OwogICAgYWRkSGlzdG9yeShlbnRyeSk7CiAgICByZWZyZXNoKCk7CiAgICByZXR1cm4gZW50cnkuaWQ7CiAgfSwgW3JlZnJlc2hdKTsKCiAgY29uc3QgdG9nZ2xlRmF2b3JpdGUgPSB1c2VDYWxsYmFjaygoaWQ6IHN0cmluZykgPT4geyB0b2dnbGVGYXYoaWQpOyByZWZyZXNoKCk7IH0sIFtyZWZyZXNoXSk7CiAgY29uc3QgcmF0ZUVudHJ5ID0gdXNlQ2FsbGJhY2soKGlkOiBzdHJpbmcsIHJhdGluZzogbnVtYmVyKSA9PiB7IHJhdGUoaWQsIHJhdGluZyk7IHJlZnJlc2goKTsgfSwgW3JlZnJlc2hdKTsKICBjb25zdCBkZWxldGVFbnRyeSA9IHVzZUNhbGxiYWNrKChpZDogc3RyaW5nKSA9PiB7IGRlbGV0ZUhpc3RvcnkoaWQpOyByZWZyZXNoKCk7IH0sIFtyZWZyZXNoXSk7CiAgY29uc3QgY2xlYXJIaXN0b3J5ID0gdXNlQ2FsbGJhY2soKCkgPT4geyBjbGVhckFsbCgpOyByZWZyZXNoKCk7IH0sIFtyZWZyZXNoXSk7CiAgY29uc3QgdXBkYXRlTm90ZXMgPSB1c2VDYWxsYmFjaygoaWQ6IHN0cmluZywgbm90ZXM6IHN0cmluZykgPT4geyB1cGRhdGVIaXN0b3J5KGlkLCB7IG5vdGVzIH0pOyByZWZyZXNoKCk7IH0sIFtyZWZyZXNoXSk7CgogIHJldHVybiB7IGhpc3RvcnksIGZhdm9yaXRlcywgc2F2ZVRvSGlzdG9yeSwgdG9nZ2xlRmF2b3JpdGUsIHJhdGVFbnRyeSwgZGVsZXRlRW50cnksIGNsZWFySGlzdG9yeSwgdXBkYXRlTm90ZXMsIHJlZnJlc2ggfTsKfQo=";
const h2="J3VzZSBjbGllbnQnOwoKaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB0eXBlIHsgUHJlc2V0LCBQcmVzZXRTZXR0aW5ncyB9IGZyb20gJ0AvdHlwZXMvcHJlc2V0JzsKaW1wb3J0IHR5cGUgeyBDb250ZW50VHlwZSB9IGZyb20gJ0AvdHlwZXMvcHJvbXB0JzsKaW1wb3J0IHsgZ2V0UHJlc2V0cywgYWRkUHJlc2V0LCB1cGRhdGVQcmVzZXQsIGRlbGV0ZVByZXNldCwgaW5jcmVtZW50UHJlc2V0VXNhZ2UsIHJlc2V0UHJlc2V0c1RvRGVmYXVsdCB9IGZyb20gJ0AvbGliL3ByZXNldHMvcHJlc2V0TWFuYWdlcic7CgpleHBvcnQgZnVuY3Rpb24gdXNlUHJlc2V0cygpIHsKICBjb25zdCBbcHJlc2V0cywgc2V0UHJlc2V0c10gPSB1c2VTdGF0ZTxQcmVzZXRbXT4oW10pOwoKICBjb25zdCByZWZyZXNoID0gdXNlQ2FsbGJhY2soKCkgPT4geyBzZXRQcmVzZXRzKGdldFByZXNldHMoKSk7IH0sIFtdKTsKCiAgdXNlRWZmZWN0KCgpID0+IHsgcmVmcmVzaCgpOyB9LCBbcmVmcmVzaF0pOwoKICBjb25zdCBjcmVhdGVQcmVzZXQgPSB1c2VDYWxsYmFjaygobmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBjb250ZW50VHlwZTogQ29udGVudFR5cGUsIHNldHRpbmdzOiBQcmVzZXRTZXR0aW5ncykgPT4gewogICAgY29uc3QgcHJlc2V0OiBQcmVzZXQgPSB7CiAgICAgIGlkOiBgcHJlc2V0XyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA4KX1gLAogICAgICBuYW1lLCBkZXNjcmlwdGlvbiwgY29udGVudFR5cGUsIHNldHRpbmdzLCB1c2FnZUNvdW50OiAwLCBpc0RlZmF1bHQ6IGZhbHNlLAogICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgIH07CiAgICBhZGRQcmVzZXQocHJlc2V0KTsKICAgIHJlZnJlc2goKTsKICAgIHJldHVybiBwcmVzZXQ7CiAgfSwgW3JlZnJlc2hdKTsKCiAgY29uc3QgYXBwbHlQcmVzZXQgPSB1c2VDYWxsYmFjaygoaWQ6IHN0cmluZykgPT4gewogICAgY29uc3QgcHJlc2V0ID0gcHJlc2V0cy5maW5kKHAgPT4gcC5pZCA9PT0gaWQpOwogICAgaWYgKHByZXNldCkgeyBpbmNyZW1lbnRQcmVzZXRVc2FnZShpZCk7IHJlZnJlc2goKTsgfQogICAgcmV0dXJuIHByZXNldDsKICB9LCBbcHJlc2V0cywgcmVmcmVzaF0pOwoKICBjb25zdCByZW1vdmVQcmVzZXQgPSB1c2VDYWxsYmFjaygoaWQ6IHN0cmluZykgPT4geyBkZWxldGVQcmVzZXQoaWQpOyByZWZyZXNoKCk7IH0sIFtyZWZyZXNoXSk7CiAgY29uc3QgZWRpdFByZXNldCA9IHVzZUNhbGxiYWNrKChpZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPFByZXNldD4pID0+IHsgdXBkYXRlUHJlc2V0KGlkLCB1cGRhdGVzKTsgcmVmcmVzaCgpOyB9LCBbcmVmcmVzaF0pOwogIGNvbnN0IHJlc2V0VG9EZWZhdWx0ID0gdXNlQ2FsbGJhY2soKCkgPT4geyByZXNldFByZXNldHNUb0RlZmF1bHQoKTsgcmVmcmVzaCgpOyB9LCBbcmVmcmVzaF0pOwogIGNvbnN0IGdldFByZXNldHNCeVR5cGUgPSB1c2VDYWxsYmFjaygoY29udGVudFR5cGU6IENvbnRlbnRUeXBlKSA9PiBwcmVzZXRzLmZpbHRlcihwID0+IHAuY29udGVudFR5cGUgPT09IGNvbnRlbnRUeXBlKSwgW3ByZXNldHNdKTsKCiAgcmV0dXJuIHsgcHJlc2V0cywgY3JlYXRlUHJlc2V0LCBhcHBseVByZXNldCwgcmVtb3ZlUHJlc2V0LCBlZGl0UHJlc2V0LCByZXNldFRvRGVmYXVsdCwgZ2V0UHJlc2V0c0J5VHlwZSB9Owp9Cg==";
const h3="J3VzZSBjbGllbnQnOwoKaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2sgfSBmcm9tICdyZWFjdCc7CmltcG9ydCB0eXBlIHsgQ3VzdG9tS2V5d29yZCB9IGZyb20gJ0AvdHlwZXMvbGVhcm5pbmcnOwppbXBvcnQgdHlwZSB7IENvbnRlbnRUeXBlIH0gZnJvbSAnQC90eXBlcy9wcm9tcHQnOwppbXBvcnQgeyBnZXRLZXl3b3JkcywgYWRkS2V5d29yZCwgdXBkYXRlS2V5d29yZCwgZGVsZXRlS2V5d29yZCwgZ2V0S2V5d29yZHNCeUNhdGVnb3J5IH0gZnJvbSAnQC9saWIvc3RvcmFnZS9rZXl3b3JkU3RvcmUnOwoKZXhwb3J0IGZ1bmN0aW9uIHVzZUtleXdvcmRzKCkgewogIGNvbnN0IFtrZXl3b3Jkcywgc2V0S2V5d29yZHNdID0gdXNlU3RhdGU8Q3VzdG9tS2V5d29yZFtdPihbXSk7CgogIGNvbnN0IHJlZnJlc2ggPSB1c2VDYWxsYmFjaygoKSA9PiB7IHNldEtleXdvcmRzKGdldEtleXdvcmRzKCkpOyB9LCBbXSk7CgogIHVzZUVmZmVjdCgoKSA9PiB7IHJlZnJlc2goKTsgfSwgW3JlZnJlc2hdKTsKCiAgY29uc3QgY3JlYXRlS2V5d29yZCA9IHVzZUNhbGxiYWNrKChkYXRhOiBPbWl0PEN1c3RvbUtleXdvcmQsICdpZCcgfCAnY3JlYXRlZEF0JyB8ICd1cGRhdGVkQXQnIHwgJ3VzYWdlQ291bnQnIHwgJ3N1Y2Nlc3NSYXRlJz4pID0+IHsKICAgIGNvbnN0IGtleXdvcmQ6IEN1c3RvbUtleXdvcmQgPSB7CiAgICAgIC4uLmRhdGEsIGlkOiBga3dfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIsIDgpfWAsCiAgICAgIHVzYWdlQ291bnQ6IDAsIHN1Y2Nlc3NSYXRlOiAwLAogICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICB9OwogICAgYWRkS2V5d29yZChrZXl3b3JkKTsKICAgIHJlZnJlc2goKTsKICAgIHJldHVybiBrZXl3b3JkOwogIH0sIFtyZWZyZXNoXSk7CgogIGNvbnN0IGVkaXRLZXl3b3JkID0gdXNlQ2FsbGJhY2soKGlkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8Q3VzdG9tS2V5d29yZD4pID0+IHsgdXBkYXRlS2V5d29yZChpZCwgdXBkYXRlcyk7IHJlZnJlc2goKTsgfSwgW3JlZnJlc2hdKTsKICBjb25zdCByZW1vdmVLZXl3b3JkID0gdXNlQ2FsbGJhY2soKGlkOiBzdHJpbmcpID0+IHsgZGVsZXRlS2V5d29yZChpZCk7IHJlZnJlc2goKTsgfSwgW3JlZnJlc2hdKTsKICBjb25zdCBmaWx0ZXJCeUNhdGVnb3J5ID0gdXNlQ2FsbGJhY2soKGNhdGVnb3J5OiBDdXN0b21LZXl3b3JkWydjYXRlZ29yeSddKSA9PiBnZXRLZXl3b3Jkc0J5Q2F0ZWdvcnkoY2F0ZWdvcnkpLCBbXSk7CiAgY29uc3QgZmlsdGVyQnlDb250ZW50VHlwZSA9IHVzZUNhbGxiYWNrKChjb250ZW50VHlwZTogQ29udGVudFR5cGUpID0+IGtleXdvcmRzLmZpbHRlcihrID0+IGsuY29udGVudFR5cGVzLmluY2x1ZGVzKGNvbnRlbnRUeXBlKSksIFtrZXl3b3Jkc10pOwoKICByZXR1cm4geyBrZXl3b3JkcywgY3JlYXRlS2V5d29yZCwgZWRpdEtleXdvcmQsIHJlbW92ZUtleXdvcmQsIGZpbHRlckJ5Q2F0ZWdvcnksIGZpbHRlckJ5Q29udGVudFR5cGUsIHJlZnJlc2ggfTsKfQo=";
